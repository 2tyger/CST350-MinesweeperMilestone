@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["Title"] = "Start Game";
}

<h2>Start the Game</h2>
<div class="row mb-3">
    <div class="col-md-6">
        <label for="rowsInput" class="form-label">Rows</label>
        <input id="rowsInput" type="number" min="5" max="24" value="9" class="form-control" />
    </div>
    <div class="col-md-6">
        <label for="colsInput" class="form-label">Columns</label>
        <input id="colsInput" type="number" min="5" max="30" value="9" class="form-control" />
    </div>
</div>
<div class="row mb-3">
    <div class="col-md-6">
        <label for="minesInput" class="form-label">Mines</label>
        <input id="minesInput" type="number" min="1" value="10" class="form-control" />
    </div>
    <div class="col-md-6 d-flex align-items-end">
        <button id="newGameBtn" class="btn btn-primary me-2">New Game</button>
        <button id="resetBtn" class="btn btn-outline-secondary">Reset</button>
    </div>
</div>

<div class="mb-2">
    <span id="statusMsg">Click "New Game" to start.</span>
    <span class="ms-3">Mines: <strong id="minesLeft">0</strong></span>
    <span class="ms-3">Time: <strong id="timer">0</strong>s</span>
    <span class="ms-3">Server Time: <strong id="serverTime">--</strong></span>
</div>

<div id="boardContainer" class="mt-3"></div>

<style>
    #boardContainer {
        display: inline-block;
        border: 2px solid #444;
        padding: 6px;
        background: #e9ecef;
    }

    .ms-cell {
        width: 36px;
        height: 36px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: 1px solid #777;
        background: linear-gradient(#fff,#ddd);
        font-weight: 600;
        cursor: pointer;
        user-select: none;
    }

    .ms-cell.revealed {
        background: #cfcfcf;
        cursor: default;
        box-shadow: inset 0 0 3px rgba(0,0,0,0.2);
    }

    .ms-cell.flagged {
        background: #ffdede;
        color: red;
    }

    .ms-cell.mine {
        background: #ff6666;
    }

    .ms-row { display: block; }
</style>

@section Scripts {
    <script src="~/js/minesweeper.js"></script>
    <script>
        // wire up controls
        document.getElementById('newGameBtn').addEventListener('click', function () {
            const rows = parseInt(document.getElementById('rowsInput').value, 10);
            const cols = parseInt(document.getElementById('colsInput').value, 10);
            const mines = parseInt(document.getElementById('minesInput').value, 10);
            Minesweeper.init(rows, cols, mines);
        });

        document.getElementById('resetBtn').addEventListener('click', function () {
            Minesweeper.reset();
        });

        // start a default game on load
        window.addEventListener('load', function () {
            const rows = parseInt(document.getElementById('rowsInput').value, 10);
            const cols = parseInt(document.getElementById('colsInput').value, 10);
            const mines = parseInt(document.getElementById('minesInput').value, 10);
            Minesweeper.init(rows, cols, mines);
        });
    </script>
}
